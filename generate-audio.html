<!DOCTYPE html>
<html>

<head>
    <title>Audio Generator</title>
</head>

<body>
    <h1>Generating Audio Files...</h1>
    <script>
        // Generate warning sound (30s alert)
        function generateWarningSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const sampleRate = audioContext.sampleRate;
            const duration = 0.5;
            const buffer = audioContext.createBuffer(1, sampleRate * duration, sampleRate);
            const data = buffer.getChannelData(0);

            for (let i = 0; i < buffer.length; i++) {
                const t = i / sampleRate;
                // Beep sound at 800Hz
                data[i] = Math.sin(2 * Math.PI * 800 * t) * Math.exp(-3 * t);
            }

            return buffer;
        }

        // Generate ready sound (spell available)
        function generateReadySound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const sampleRate = audioContext.sampleRate;
            const duration = 0.8;
            const buffer = audioContext.createBuffer(1, sampleRate * duration, sampleRate);
            const data = buffer.getChannelData(0);

            for (let i = 0; i < buffer.length; i++) {
                const t = i / sampleRate;
                // Ascending tone (success sound)
                const freq = 400 + (t * 400);
                data[i] = Math.sin(2 * Math.PI * freq * t) * Math.exp(-2 * t);
            }

            return buffer;
        }

        // Convert buffer to WAV and download
        function bufferToWav(buffer) {
            const length = buffer.length * 2;
            const wav = new ArrayBuffer(44 + length);
            const view = new DataView(wav);
            const sampleRate = buffer.sampleRate;
            const data = buffer.getChannelData(0);

            // WAV header
            writeString(view, 0, 'RIFF');
            view.setUint32(4, 36 + length, true);
            writeString(view, 8, 'WAVE');
            writeString(view, 12, 'fmt ');
            view.setUint32(16, 16, true);
            view.setUint16(20, 1, true);
            view.setUint16(22, 1, true);
            view.setUint32(24, sampleRate, true);
            view.setUint32(28, sampleRate * 2, true);
            view.setUint16(32, 2, true);
            view.setUint16(34, 16, true);
            writeString(view, 36, 'data');
            view.setUint32(40, length, true);

            // PCM data
            let offset = 44;
            for (let i = 0; i < data.length; i++) {
                const sample = Math.max(-1, Math.min(1, data[i]));
                view.setInt16(offset, sample < 0 ? sample * 0x8000 : sample * 0x7FFF, true);
                offset += 2;
            }

            return new Blob([view], { type: 'audio/wav' });
        }

        function writeString(view, offset, string) {
            for (let i = 0; i < string.length; i++) {
                view.setUint8(offset + i, string.charCodeAt(i));
            }
        }

        function download(blob, filename) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Generate and download
        setTimeout(() => {
            const warningBuffer = generateWarningSound();
            const warningBlob = bufferToWav(warningBuffer);
            download(warningBlob, 'warning.wav');

            setTimeout(() => {
                const readyBuffer = generateReadySound();
                const readyBlob = bufferToWav(readyBuffer);
                download(readyBlob, 'ready.wav');
                alert('Audio files generated! Please convert to MP3 and place in sounds/ folder.');
            }, 500);
        }, 1000);
    </script>
</body>

</html>